/*
	http://wiki.kumbiaphp.com/Licencia	 New BSD License
*/
(function(a){a.KumbiaPHP={publicPath:null,plugin:[],cConfirm:function(b){var c=a(this);confirm(c.data("msg"))||b.preventDefault()},cFx:function(b){return function(c){c.preventDefault();c=a(this);a("#"+c.data("to"))[b]()}},
cRemote:function(b){var c=a(this),c=a("#"+c.data("to"));b.preventDefault();/*$("#choque").html(" ");*/c.load(this.href);/*$("#choque").html(" ")*/},
cRemoteConfirm:function(b){var c=a(this),d=a("#"+c.data("to"));b.preventDefault();confirm(c.data("msg"))&&d.load(this.href)},
cSRemote:function(b){b.preventDefault();c=a(this);var _url=c.attr("action")+"/"+c.val();var f=c.attr("data-to");a.ajax({type: "POST",url: _url,data: c.attr("name")+"="+c.val(),success: function(data){$("#"+f).html(data);}});},
cSIRemote:function(b){
	b.preventDefault();
	c=a(this);
	var _url=c.attr("action")+"/"+c.val();
	var f=c.attr("data-to");
	a.ajax({
		type: "POST",
		url: _url,
		data: c.attr("name")+"="+c.val(),
		//beforeSend: function () {
        //    $("#choque").html("Cargando...");
        //},
		success: function(data){
			a("#"+f).html(data);
			/*if(f.substr(0,6)=='codsec'){
				$("#choque").load('procesos/choque');
			}else{
				$("#choque").html(" ");
			}*/
		}
		
	});
},

cFRemote:function(b){b.preventDefault();este=a(this);var c=a("[type=submit]",este);c.attr("disabled","disabled");b=este.attr("action");var d=este.attr("data-to");a.post(b,este.serialize(),function(b){var e=a("#"+d);e.html(b);e.hide();e.show();c.attr("disabled",null)})},cUpdaterSelect:function(){var b=a(this),c=a("#"+b.data("update"));url=b.data("url");c.empty();a.get(url,{id:b.val()},function(b){for(i in b){var f=a("<option />").text(b[i]).val(i);c.append(f)}},"json")},

bind:function(){a("a.js-confirm, input.js-confirm").on("click",this.cConfirm);
//a("a.js-remote").on("click",this.cRemote);
a(document).on("click","a.js-remote",this.cRemote);

//a("a.js-remote-confirm").on("click",this.cRemoteConfirm);
a(document).on("click","a.js-remote-confirm",this.cRemoteConfirm);
a("a.js-show").on("click",this.cFx("show"));
a("a.js-hide").on("click",this.cFx("hide"));
a("a.js-toggle").on("click",this.cFx("toggle"));
a("a.js-fade-in").on("click",this.cFx("fadeIn"));
a("a.js-fade-out").on("click",this.cFx("fadeOut"));
//a("form.js-remote").on("submit",this.cFRemote);
a(document).on("submit","form.js-remote",this.cFRemote);

//a("select.js-remote").on("change",this.cUpdaterSelect);
a(document).on("change","select.js-remote",this.cSIRemote);
a(document).on("change","select.js-remote-inscripcion",this.cSIRemote);

a.KumbiaPHP.bindDatePicker()},autoload:function(){var b=a("[class*='jp-']");a.each(b,function(b){var d=a(this).attr("class").split(" ");for(b in d)"jp-"==d[b].substr(0,3)&&-1==a.inArray(d[b].substr(3),a.KumbiaPHP.plugin)&&a.KumbiaPHP.plugin.push(d[b].substr(3))});b=a("head");for(i in a.KumbiaPHP.plugin)a.ajaxSetup({cache:!0}),b.append('<link href="'+a.KumbiaPHP.publicPath+"css/"+a.KumbiaPHP.plugin[i]+'.css" type="text/css" rel="stylesheet"/>'),a.getScript(a.KumbiaPHP.publicPath+"javascript/jquery/jquery."+a.KumbiaPHP.plugin[i]+".js",function(){})},bindDatePicker:function(){var b=a("input.js-datepicker"),c=function(){b.each(function(){var b={monthSelector:!0,yearSelector:!0},c=a(this);void 0!=c.attr("min")&&(b.dateMin=c.attr("min").split("-"));void 0!=c.attr("max")&&(b.dateMax=c.attr("max").split("-"));c.pickadate(b)})};
/*if("undefined"!=typeof a.pickadate)return c();
a("head").append('<link href="'+this.publicPath+'css/pickadate.css" type="text/css" rel="stylesheet"/>');
jQuery.ajax({dataType:"script",cache:!0,url:this.publicPath+"javascript/jquery/pickadate.js"}).done(function(){c()})*/},initialize:function(){var b=a("script:last").attr("src");this.publicPath=b.substr(0,b.length-37);a(function(){a.KumbiaPHP.bind();a.KumbiaPHP.autoload()})}};/*a.KumbiaPHP.initialize()*/})(jQuery);
